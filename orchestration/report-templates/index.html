<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{auv_id}} - Swarm1 Delivery Report</title>
    {{styles}}
  </head>
  <body>
    <div class="container">
      <!-- Header Section -->
      <header>
        <div class="logo">
          <h1>ðŸš€ {{auv_id}} Delivery Report</h1>
          <span class="version">Manifest v{{version}}</span>
        </div>
        <div class="header-info">
          <div class="info-item">
            <span class="label">Run ID:</span>
            <span class="value">{{run_id}}</span>
          </div>
          <div class="info-item">
            <span class="label">Built:</span>
            <span class="value">{{built_at}}</span>
          </div>
          <div class="info-item">
            <span class="label">Environment:</span>
            <span class="value">{{ci_environment}}</span>
          </div>
        </div>
      </header>

      <!-- Executive Summary -->
      <section class="summary">
        <h2>Executive Summary</h2>
        <div class="summary-grid">
          <div class="summary-card">
            <h3>CVF Validation</h3>
            <div class="metric {{cvf_status_class}}">{{cvf_status}}</div>
            <div class="detail">{{artifacts_count}} artifacts verified</div>
          </div>
          <div class="summary-card">
            <h3>Performance Score</h3>
            <div class="metric perf-score {{perf_score_class}}">{{perf_score}}%</div>
            <div class="detail">Lighthouse audit</div>
          </div>
          <div class="summary-card">
            <h3>Security Scan</h3>
            <div class="metric">{{security_status}}</div>
            <div class="detail">{{security_details}}</div>
          </div>
          <div class="summary-card">
            <h3>Visual Regression</h3>
            <div class="metric">{{visual_status}}</div>
            <div class="detail">{{visual_details}}</div>
          </div>
        </div>
      </section>

      <!-- Build Information -->
      <section class="build-info">
        <h2>Build Information</h2>
        <div class="info-grid">
          <div class="info-section">
            <h3>Repository</h3>
            <table class="info-table">
              <tr>
                <th>Commit SHA</th>
                <td><code>{{commit_sha}}</code></td>
              </tr>
              <tr>
                <th>Branch</th>
                <td>{{commit_branch}}</td>
              </tr>
              <tr>
                <th>Message</th>
                <td class="commit-message">{{commit_message}}</td>
              </tr>
            </table>
          </div>
          <div class="info-section">
            <h3>Environment</h3>
            <table class="info-table">
              <tr>
                <th>Node Version</th>
                <td>{{node_version}}</td>
              </tr>
              <tr>
                <th>Platform</th>
                <td>{{os_platform}}</td>
              </tr>
              <tr>
                <th>CI Run</th>
                <td><a href="{{ci_link}}" target="_blank">{{ci_run_id}}</a></td>
              </tr>
            </table>
          </div>
        </div>
      </section>

      <!-- Performance Metrics -->
      <section class="performance">
        <h2>Performance Metrics</h2>
        <div class="perf-container">
          <div class="perf-score-display">
            <div class="score-circle {{perf_score_class}}">
              <span class="score-value">{{perf_score}}</span>
              <span class="score-label">Score</span>
            </div>
          </div>
          <div class="perf-details">
            <h3>Execution Times</h3>
            <ul class="timing-list">
              <li>
                <span class="timing-label">Total Duration:</span>
                <span class="timing-value">{{duration_total}}</span>
              </li>
              <li>
                <span class="timing-label">Runbook Execution:</span>
                <span class="timing-value">{{duration_runbook}}</span>
              </li>
              <li>
                <span class="timing-label">Package Creation:</span>
                <span class="timing-value">{{duration_packaging}}</span>
              </li>
            </ul>

            <h3>Performance Budgets</h3>
            <div class="budget-status budget-{{budget_status}}">Status: {{budget_status}}</div>
            <ul class="violations-list">
              {{budget_violations}}
            </ul>
          </div>
        </div>
      </section>

      <!-- Screenshots Gallery -->
      <section class="screenshots">
        <h2>Visual Proofs</h2>
        <div class="screenshots-gallery">{{screenshots}}</div>
      </section>

      <!-- Artifacts Inventory -->
      <section class="artifacts">
        <h2>Artifacts Inventory</h2>
        <div class="artifacts-header">
          <span>Total: {{artifacts_count}} artifacts</span>
          <span class="missing-count">Missing: {{missing_count}}</span>
        </div>
        <table class="artifacts-table">
          <thead>
            <tr>
              <th>Path</th>
              <th>Type</th>
              <th>Size</th>
              <th>SHA-256</th>
            </tr>
          </thead>
          <tbody>
            {{artifacts_table}}
          </tbody>
        </table>
      </section>

      <!-- Bundle Information -->
      <section class="bundle">
        <h2>Delivery Bundle</h2>
        <div class="bundle-info">
          <div class="bundle-item">
            <span class="bundle-label">Package Size:</span>
            <span class="bundle-value">{{bundle_size}}</span>
          </div>
          <div class="bundle-item">
            <span class="bundle-label">Checksum:</span>
            <span class="bundle-value checksum">{{bundle_sha}}...</span>
          </div>
          <div class="bundle-item">
            <span class="bundle-label">Tool Versions:</span>
            <span class="bundle-value">{{tool_versions}}</span>
          </div>
        </div>
      </section>

      <!-- Provenance & Attestation -->
      <section class="provenance">
        <h2>Provenance & Attestation</h2>
        <div class="provenance-card">
          <div class="provenance-item"><strong>Built By:</strong> {{built_by}}</div>
          <div class="provenance-item"><strong>Build Time:</strong> {{built_at}}</div>
          <div class="provenance-item">
            <strong>Integrity:</strong> All artifacts have been checksummed and included in the
            signed manifest
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer>
        <div class="footer-content">
          <p>Generated by <strong>Swarm1 Packaging System</strong> v1.1</p>
          <p>This report is part of the verified delivery bundle for {{auv_id}}</p>
          <div class="footer-actions">
            <button onclick="showManifest()" class="btn-manifest">View Full Manifest</button>
            <button onclick="window.print()" class="btn-print">Print Report</button>
          </div>
        </div>
      </footer>

      <!-- Manifest Modal -->
      <div id="manifest-modal" class="modal" style="display: none">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Full Manifest</h2>
            <button onclick="hideManifest()" class="modal-close">Ã—</button>
          </div>
          <div class="modal-body">
            <pre>{{manifest_json}}</pre>
          </div>
        </div>
      </div>
    </div>

    <script>
      function showManifest() {
        document.getElementById('manifest-modal').style.display = 'flex';
      }

      function hideManifest() {
        document.getElementById('manifest-modal').style.display = 'none';
      }

      // Close modal on escape key
      document.addEventListener('keydown', function (event) {
        if (event.key === 'Escape') {
          hideManifest();
        }
      });

      // Close modal on background click
      document.getElementById('manifest-modal').addEventListener('click', function (event) {
        if (event.target === this) {
          hideManifest();
        }
      });
    </script>
  </body>
</html>
